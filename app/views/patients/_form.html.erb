<div class="container mt-4">
  <div class="row">
    <div class="col-md-12">
      <div class="card shadow">
        <div class="card-header bg-primary text-white">
          <h3 class="mb-0">
            <i class="fas fa-user-plus"></i> 
            <%= @patient.new_record? ? "Ajouter un patient" : "Modifier le patient" %>
          </h3>
        </div>
        <div class="card-body p-4">
          <h5 class="text-muted mb-4">Veuillez saisir les informations du patient</h5>

          <%= simple_form_for @patient, html: { class: 'patient-form' } do |f| %>
            <div class="row">
              <!-- Colonne gauche -->
              <div class="col-md-6">
                <%= f.input :numero_dossier, 
                            label: "N° Dossier", 
                            hint: "Laissez vide pour génération automatique",
                            input_html: { placeholder: "Auto-généré" } %>

                <%= f.input :civilite, 
                            label: "Civilité",
                            collection: Patient::CIVILITES,
                            include_blank: "---------",
                            input_html: { class: 'form-select' } %>

                <%= f.input :nom, 
                            label: "Nom",
                            required: true,
                            input_html: { class: 'text-uppercase' } %>

                <%= f.input :prenom, 
                            label: "Prénom",
                            required: true %>

                <%= f.input :sexe, 
                            label: "Sexe",
                            collection: Patient::SEXES,
                            include_blank: "---------",
                            input_html: { class: 'form-select' } %>

                <div class="row">
                  <div class="col-4">
                    <%= f.input :indicatif_pays, 
                                label: "Indicatif",
                                input_html: { value: '+212', class: 'form-control' } %>
                  </div>
                  <div class="col-8">
                    <%= f.input :telephone, 
                                label: "Téléphone",
                                required: true,
                                input_html: { placeholder: "650-123456" } %>
                  </div>
                </div>

                <%= f.input :date_naissance, 
                            label: "Date naissance",
                            as: :date,
                            start_year: Date.today.year - 100,
                            end_year: Date.today.year,
                            order: [:day, :month, :year],
                            input_html: { class: 'form-control' } %>

                <%= f.input :profession, 
                            label: "Profession" %>

                <%= f.input :adresse, 
                            label: "Adresse",
                            as: :text,
                            input_html: { rows: 3 } %>
              </div>

              <!-- Colonne droite -->
              <div class="col-md-6">
                <%= f.input :cin, 
                            label: "CIN",
                            input_html: { placeholder: "Carte d'identité nationale" } %>

                <%= f.input :situation_familiale, 
                            label: "Situation familiale",
                            collection: Patient::SITUATIONS_FAMILIALES,
                            include_blank: "---------",
                            input_html: { class: 'form-select' } %>

                <%= f.input :lead_status, 
                            label: "Lead Status",
                            collection: Patient::LEAD_STATUS,
                            include_blank: "---------",
                            input_html: { class: 'form-select' } %>

                <%= f.input :mutuelle, 
                            label: "Mutuelle",
                            collection: ['CNOPS', 'CNSS', 'RMA', 'Saham', 'Wafa', 'Autre'],
                            include_blank: "---------",
                            input_html: { class: 'form-select' } %>

                <%= f.input :immatriculation, 
                            label: "Immatriculation",
                            hint: "Numéro de sécurité sociale",
                            input_html: { placeholder: "N° sécurité sociale" } %>

                <%= f.input :commentaire, 
                            label: "Commentaire",
                            as: :text,
                            input_html: { rows: 3 } %>

                <%= f.input :provenance, 
                            label: "Provenance",
                            collection: Patient::PROVENANCES,
                            include_blank: "---------",
                            input_html: { class: 'form-select' } %>

                <%= f.input :ville, 
                            label: "Ville" %>
              </div>
            </div>

            <div class="d-flex gap-2 mt-4 justify-content-end">
              <%= link_to patients_path, class: "btn btn-danger" do %>
                <i class="fas fa-times"></i> Annuler
              <% end %>
              <%= f.button :submit, class: "btn btn-success" do %>
                <i class="fas fa-save"></i> Enregistrer
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
